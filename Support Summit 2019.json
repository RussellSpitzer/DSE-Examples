{"paragraphs":[{"title":"Imports","text":"import org.apache.spark.sql.cassandra._\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport collection.JavaConverters._\nimport com.datastax.bdp.graph.spark.graphframe._","user":"anonymous","dateUpdated":"2019-02-01T09:08:24-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548874842972_280638761","id":"20190130-130042_385245180","dateCreated":"2019-01-30T13:00:42-0600","dateStarted":"2019-02-01T09:08:13-0600","dateFinished":"2019-02-01T09:08:23-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3545"},{"title":"Setup","text":"// Setup\n// Make sure you started up the cluster with AlwaysOnSqlServer enabled and it's corrosoponding workpools section\n// Also make sure to use search, analytics and graph (-s -k -g)\n\nval DESTROYKS = \"DROP KEYSPACE IF EXISTS ks\"\nval KSDDL = \"CREATE KEYSPACE IF NOT EXISTS ks WITH replication = {'class': 'NetworkTopologyStrategy', 'SearchGraphAnalytics': 1}\"\nval TABDDL = \"\"\"CREATE TABLE IF NOT EXISTS ks.tab (\n    k int PRIMARY KEY,\n    v int\n)\"\"\"\nval PreparedInsert = \"INSERT INTO ks.tab (k,v) VALUES (?,?)\"\n\n\nCassandraConnector(sc.getConf).withSessionDo { session =>\n  session.execute(DESTROYKS)\n  session.execute(KSDDL)\n  session.execute(TABDDL)\n  val ps = session.prepare(PreparedInsert)\n  val futures = for (i <- 1 to 1000) yield {\n      session.executeAsync(ps.bind(i: java.lang.Integer, i: java.lang.Integer))\n  }\n  futures.foreach(_.get)\n  session.execute(\"SELECT * FROM ks.tab LIMIT 10\").asScala.foreach(println)\n}\n\n","user":"anonymous","dateUpdated":"2019-01-31T15:13:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548868149204_555576701","id":"20190130-110909_1921599502","dateCreated":"2019-01-30T11:09:09-0600","dateStarted":"2019-01-31T15:13:36-0600","dateFinished":"2019-01-31T15:13:38-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3546"},{"title":"API Entry Points","text":"//Spark Session - Modern Entry point to Spark\nspark\n\n//SqlContext - Old Interface to SparkSQL\nsqlContext\n//SparkContext - Old Interface to Spark\nsc","user":"anonymous","dateUpdated":"2019-01-30T12:59:52-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548868204339_-1484531450","id":"20190130-111004_646237586","dateCreated":"2019-01-30T11:10:04-0600","dateStarted":"2019-01-30T12:41:41-0600","dateFinished":"2019-01-30T12:41:41-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3547"},{"title":"Reading from Cassandra with a Dataframe","text":"{\nspark\n  .read\n  .cassandraFormat(\"tab\",\"ks\")\n  .load\n  .show\n}","user":"anonymous","dateUpdated":"2019-01-30T13:03:46-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548874749169_-1896748250","id":"20190130-125909_622928238","dateCreated":"2019-01-30T12:59:09-0600","dateStarted":"2019-01-30T13:03:46-0600","dateFinished":"2019-01-30T13:03:46-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3548"},{"title":"Writing to Cassandra with a Dataframe","text":"//Let's load some data \n\n{\nspark.range(1001, 2000)\n  .withColumn(\"k\", 'id)\n  .withColumn(\"v\", 'id)\n  .select(\"k\",\"v\")\n  .write\n  .cassandraFormat(\"tab\", \"ks\")\n  .mode(\"append\")\n  .save()\n}","user":"anonymous","dateUpdated":"2019-01-30T13:00:37-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548873578553_130239816","id":"20190130-123938_819749566","dateCreated":"2019-01-30T12:39:38-0600","dateStarted":"2019-01-30T12:55:37-0600","dateFinished":"2019-01-30T12:56:17-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3549"},{"title":"Write Cassandra Data to a Parquet Directory in DSEFS","text":"{\nspark\n  .read\n  .cassandraFormat(\"tab\",\"ks\")\n  .load\n  .write\n  .mode(\"overwrite\")\n  .save(\"myParquet\")\n  \nspark\n  .read\n  .load(\"myParquet\")\n  .show()\n}","user":"anonymous","dateUpdated":"2019-01-30T13:05:24-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548873950862_-1532614356","id":"20190130-124550_51396302","dateCreated":"2019-01-30T12:45:50-0600","dateStarted":"2019-01-30T13:05:24-0600","dateFinished":"2019-01-30T13:05:27-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3550"},{"title":"Access DSEFS Directly","text":"import org.apache.hadoop.fs.{FileSystem, Path}\n\n//Because this is DSE it auto loads our DSE Conf files\nval hadoopConf = sc.hadoopConfiguration\n\nval dsefs = FileSystem.get(hadoopConf)\n\nval it = dsefs.listFiles(new Path(\"/\"), true)\n\nwhile (it.hasNext()) {\n    println(it.next().getPath)\n}","user":"anonymous","dateUpdated":"2019-01-30T13:19:07-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548875070516_-1306276562","id":"20190130-130430_678019529","dateCreated":"2019-01-30T13:04:30-0600","dateStarted":"2019-01-30T13:19:07-0600","dateFinished":"2019-01-30T13:19:09-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3551"},{"title":"SQL Scan","text":"%sql\nSELECT * FROM ks.tab limit 5","user":"anonymous","dateUpdated":"2019-01-30T14:00:04-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":194,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"k":"string","v":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548875238991_-1315483501","id":"20190130-130718_1751459613","dateCreated":"2019-01-30T13:07:18-0600","dateStarted":"2019-01-30T13:21:48-0600","dateFinished":"2019-01-30T13:21:49-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3552"},{"title":"Doing and Aggregation in SQL","text":"%sql\nSELECT Sum(v) FRom ks.tab","user":"anonymous","dateUpdated":"2019-01-30T14:00:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sum(v)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548876100814_-271512420","id":"20190130-132140_636990680","dateCreated":"2019-01-30T13:21:40-0600","dateStarted":"2019-01-30T13:22:04-0600","dateFinished":"2019-01-30T13:22:05-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3553"},{"title":"Pushdown in Spark SQL","text":"%sql\nEXPLAIN SELECT * FROM ks.tab WHERE k = 50","user":"anonymous","dateUpdated":"2019-01-30T14:01:14-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":94,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"plan":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548877424047_-792741574","id":"20190130-134344_899063925","dateCreated":"2019-01-30T13:43:44-0600","dateStarted":"2019-01-30T14:01:02-0600","dateFinished":"2019-01-30T14:01:03-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3554"},{"title":"Graph Frames","text":"// Loaded up studio and ran through the \"QuickStart\" Notebook to generate some data\nval graphFrame = spark.dseGraph(\"DSE_GRAPH_QUICKSTART\")\ngraphFrame.V().filter(col(\"~label\") === lit(\"recipe\")).show","user":"anonymous","dateUpdated":"2019-02-01T09:11:47-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.151.0.25:4041/jobs/job?id=4","http://10.151.0.25:4041/jobs/job?id=5","http://10.151.0.25:4041/jobs/job?id=6"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548878462912_-2048853473","id":"20190130-140102_1742721859","dateCreated":"2019-01-30T14:01:02-0600","dateStarted":"2019-02-01T09:11:01-0600","dateFinished":"2019-02-01T09:11:03-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3555"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549034324146_1777023114","id":"20190201-091844_1319992060","dateCreated":"2019-02-01T09:18:44-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3556"},{"title":"Can Use Tinkerpop3 as well","text":"graphFrame.V.has(\"name\", \"Rataouille\").out().show","user":"anonymous","dateUpdated":"2019-02-01T09:18:44-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.151.0.25:4041/jobs/job?id=21","http://10.151.0.25:4041/jobs/job?id=22","http://10.151.0.25:4041/jobs/job?id=23","http://10.151.0.25:4041/jobs/job?id=24","http://10.151.0.25:4041/jobs/job?id=25"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1549033619437_-1388913578","id":"20190201-090659_1769485929","dateCreated":"2019-02-01T09:06:59-0600","dateStarted":"2019-02-01T09:18:01-0600","dateFinished":"2019-02-01T09:18:04-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3557"},{"title":"Another TP Example","text":"graphFrame.V().has(\"name\", \"Julia Child\").out().out().hasLabel(\"ingredient\").show()\ngraphFrame.V().has(\"name\", \"Julia Child\").out().out().hasLabel(\"ingredient\").explain()\ngraphFrame.V().has(\"name\", \"Julia Child\").out().out().hasLabel(\"ingredient\").toDF.explain()","user":"anonymous","dateUpdated":"2019-02-01T09:31:42-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.151.0.25:4041/jobs/job?id=51","http://10.151.0.25:4041/jobs/job?id=52","http://10.151.0.25:4041/jobs/job?id=53","http://10.151.0.25:4041/jobs/job?id=54","http://10.151.0.25:4041/jobs/job?id=55"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1549034212425_2000160228","id":"20190201-091652_964936096","dateCreated":"2019-02-01T09:16:52-0600","dateStarted":"2019-02-01T09:31:32-0600","dateFinished":"2019-02-01T09:31:35-0600","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3558"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549034501232_-1382951101","id":"20190201-092141_1140117486","dateCreated":"2019-02-01T09:21:41-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3559"}],"name":"Support Summit 2019","id":"2E4TEH361","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}